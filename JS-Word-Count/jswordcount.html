<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css">
.formLine {
	padding: 5px;
	margin-bottom: 5px;
}
</style>
<script type="text/javascript">
	function getAnswer() {
		var searchText = document.forms["input"]["searchText"].value;
		var keyword = document.forms["input"]["keyword"].value;
		var spaces = document.forms["input"]["spaces"].checked;
				
		if (keyword.length == 0) {
			document.getElementById('answer').innerHTML = "Length of search text: " + searchText.length; 
		} else {
			document.getElementById('answer').innerHTML = "Occurrences of '" + keyword + "': " + countKeyword(searchText, keyword, spaces)
		}	
		
	}
	
	function countKeyword(searchText, keyword, spaces) {
		var count = 0;
		
		if (spaces) {
			count = getSpacesCount(searchText, keyword)
		} else {
			count = getNoSpacesCount(searchText, keyword)
		}	
		
		return count;
	}
	
	function getSpacesCount(searchText, keyword) {
		var count = 0;
		
		if (keyword == searchText) {
			count++;
		} else if (keyword.length < searchText.length) {
			count = getNoSpacesCount(searchText, " " + keyword + " ");
			
			if (searchText.substring(0, keyword.length + 1) == keyword + " ") {
				count++;
			}
			if (searchText.substring(searchText.length - keyword.length - 1) == " " + keyword) {
				count++;
			} 
		}		
		
		return count;
	}
	
	function getNoSpacesCount(searchText, keyword) {
		var count = 0;
		
		for(i = 0; i + keyword.length <= searchText.length; i++) {
			if (searchText.substring(i, keyword.length + i) == keyword) {
				count++;
			}
		}
		
		return count;
	}	
</script>
<title>JavaScript Word Count</title>
</head>
<body style="padding-top: 10px;">
	<form name="input">
		<div class="formLine">
			<div>Text To Search:</div>
			<textarea name="searchText" rows="10" cols="50"></textarea>
		</div>
		<div class="formLine">
			Text to Count: <input type="text" name="keyword">
			<div style="font-size: .8em; font-style: italic; color: red;">Counts length of search text if left empty.</div>
		</div>
		<div class="formLine"><input type="checkbox" name="spaces">Require Space Before/After words</div>
		<div class="formLine">
			<input type="button" value="Submit" onclick="return getAnswer();">
			<span id="answer" style="padding-left: 10px; font-weight: bold;"></span>
		</div>		
	</form>
</body>
</html>